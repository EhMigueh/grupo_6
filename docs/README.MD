ACÁ VA EL FUNCIOMIENTO DEL CÓDIGO...